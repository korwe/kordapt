<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:c="http://www.springframework.org/schema/c"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd ">

    <!-- BoneCP configuration -->
    <bean id="dataSource" class="com.jolbox.bonecp.BoneCPDataSource" destroy-method="close"
        p:driverClass="org.postgresql.Driver"
        p:jdbcUrl="jdbc:postgresql://${db.host}:${db.port}/${db.database}?characterEncoding=utf8"
        p:username="${db.username}"
        p:password="${db.password}"
        p:idleConnectionTestPeriodInSeconds="60"
        p:idleMaxAgeInSeconds="240"
        p:maxConnectionsPerPartition="11"
        p:minConnectionsPerPartition="1"
        p:partitionCount="2"
        p:acquireIncrement="10"
        p:statementsCacheSize="50"
        p:releaseHelperThreads="3"/>


    <!-- Only create connections when necessary -->
    <bean id="lazyDataSource"
          class="org.springframework.jdbc.datasource.LazyConnectionDataSourceProxy"
          p:targetDataSource-ref="dataSource" />
</beans>